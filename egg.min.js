!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.egg=e():r.egg=e()}(window,function(){return function(r){var e={};function n(t){if(e[t])return e[t].exports;var o=e[t]={i:t,l:!1,exports:{}};return r[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=r,n.c=e,n.d=function(r,e,t){n.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:t})},n.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},n.t=function(r,e){if(1&e&&(r=n(r)),8&e)return r;if(4&e&&"object"==typeof r&&r&&r.__esModule)return r;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:r}),2&e&&"string"!=typeof r)for(var o in r)n.d(t,o,function(e){return r[e]}.bind(null,o));return t},n.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return n.d(e,"a",e),e},n.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},n.p="",n(n.s=0)}([function(r,e){function n(){var r;if(program=t(program),/^["']/.test(program))r={type:"value",value:function(){var r,e=program[0],n="",t=0;for(;r=program[++t];)if("\\"!=r){if(r==e)return program=program.substr(++t),n;n+=r}else n+=program[++t];throw new SyntaxError("Parse String Error")}()};else if(/^[\d.]/.test(program))r={type:"value",value:function(){var r,e=0,n="";for(;(r=program[e])&&/[\d.]/.test(r);)n+=r,e++;if(program=program.substr(e),n=Number(n),isNaN(n))throw new SyntaxError("Parse Number Error");return n}()};else{if(!/^[^\s(),"]/.test(program))throw new SyntaxError("Unexpected syntax: "+program);r={type:"word",name:function(){var r,e=0,n="";for(;(r=program[e])&&/[^\s(),"]/.test(r);)n+=r,e++;return program=program.substr(e),n}()}}return function r(e){program=t(program);if("("!=program[0])return{expr:e};program=t(program.slice(1));e={type:"apply",operator:e,args:[]};for(;")"!=program[0];){var o=n();if(e.args.push(o.expr),program=t(program),","==program[0])program=t(program.slice(1));else if(")"!=program[0])throw new SyntaxError("Expected , or )")}program=program.substr(1);return r(e)}(r)}function t(r){var e=r.search(/\S/);return-1===e?"":r.slice(e)}function o(r){program=r;var e=n();if(t(program))throw new SyntaxError("Unexpected text after program");return e.expr}function a(r,e){switch(r.type){case"value":return r.value;case"word":if(r.name in e)return e[r.name];throw new ReferenceError("undefined variable: "+r.name);case"apply":if("word"==r.operator.type&&r.operator.name in u)return u[r.operator.name](r.args,e);var n=a(r.operator,e);if("function"!=typeof n)throw new TypeError("Applying a non-function");return n.apply(null,r.args.map(function(r){return a(r,e)}))}}program="";var u=Object.create(null);u.if=function(r,e){if(3!=r.length)throw new SyntaxError("Bad number of args to if");return!1!==a(r[0],e)?a(r[1],e):a(r[2],e)},u.while=function(r,e){if(2!=r.length)throw new SyntaxError("Bad number of args to while");throw new SyntaxError("Bad number of args to while")},u.do=function(r,e){var n=!1;return r.forEach(function(r){n=a(r,e)}),n},u.define=function(r,e){if(2!=r.length||"word"!=r[0].type)throw new SyntaxError("Bad use of define");var n=a(r[1],e);return e[r[0].name]=n,n};var f=Object.create(null);f.true=!0,f.false=!1,["+","-","*","/","==","<",">"].forEach(function(r){f[r]=new Function("a","b","return a"+r+"b")}),f.print=function(r){return console.log(r),r},u.fun=function(r,e){if(!r.length)throw new SyntaxError("Function need a body");var n=r.slice(0,r.length-1).map(function(r){if("word"!=r.type)throw new SyntaxError("Arg names must be words");return r.name}),t=r[r.length-1];return function(){if(arguments.length!=n.length)throw new TypeError("Wrong number of arguments");for(var r=Object.create(e),o=0;o<arguments.length;o++)r[n[o]]=arguments[o];return a(t,r)}},e.parse=o,e.run=function(){var r=Object.create(f);return a(o(Array.prototype.slice.call(arguments,0).join("\n")),r)}}])});